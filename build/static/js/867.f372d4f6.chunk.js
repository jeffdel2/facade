"use strict";(self.webpackChunkreact_niq_app=self.webpackChunkreact_niq_app||[]).push([[867],{4867:(e,s,t)=>{t.r(s),t.d(s,{default:()=>_});var a=t(9950),r=t(134),i=t(7321),n=t(5342),o=t(8506),l=t(5547),d=t(5310),c=t(1521),x=t(2036),u=t(6615),h=t(6060),p=t(4514),A=t(6057),m=t(6240),g=t(6812),b=t(9737),j=t(5060),v=t(6309),f=t(1672),y=t(7356),S=t(4414);const C=e=>{let{icon:s,label:t,value:a}=e;return(0,S.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",gap:1.5,p:2,backgroundColor:"rgba(0, 0, 0, 0.02)",borderRadius:2},children:[(0,S.jsx)(i.A,{sx:{color:"primary.main"},children:s}),(0,S.jsxs)(i.A,{children:[(0,S.jsx)(n.A,{variant:"body2",color:"text.secondary",children:t}),(0,S.jsx)(n.A,{variant:"subtitle1",fontWeight:"medium",children:a})]})]})},_=()=>{const{user:e,isAuthenticated:s,isLoading:t,getAccessTokenSilently:_}=(0,r.WB)(),T=(0,y.A)(),[P,w]=(0,a.useState)(!1),[E,D]=(0,a.useState)(!1),[O,R]=(0,a.useState)({open:!1,message:"",severity:"success"}),[W,k]=(0,a.useState)({address:"",phone:"",birthdate:"",preferences:{notifications:!0,newsletter:!0}});(0,a.useEffect)(()=>{null!==e&&void 0!==e&&e.sub&&(async()=>{try{const s=await _(),t=`https://${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_AUTH0_DOMAIN}/api/v2/users/${null===e||void 0===e?void 0:e.sub}`,a=await fetch(t,{headers:{Authorization:`Bearer ${s}`}}),{user_metadata:r}=await a.json();r&&k(r)}catch(s){console.error("Error fetching user metadata:",s)}})()},[_,null===e||void 0===e?void 0:e.sub]);if(t)return(0,S.jsx)(i.A,{sx:{width:"100%",mt:4},children:(0,S.jsx)(o.A,{})});if(!s||!e)return(0,S.jsx)(i.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:(0,S.jsx)(n.A,{variant:"h6",color:"text.secondary",children:"Please log in to view your profile."})});const H={points:1250,status:"Gold Member",memberSince:"January 2024",lastPurchase:"March 15, 2024",progress:75,pointsToNext:250};return(0,S.jsxs)(i.A,{sx:{maxWidth:1200,mx:"auto",p:{xs:2,md:4}},children:[(0,S.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:4},children:[(0,S.jsx)(l.A,{sx:{position:"relative",overflow:"visible",background:`linear-gradient(45deg, ${T.palette.primary.main}, ${T.palette.secondary.main})`,color:"white",p:2},children:(0,S.jsxs)(i.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"center",sm:"flex-start"},gap:3,position:"relative",zIndex:1},children:[(0,S.jsx)(d.A,{src:e.picture,alt:e.name,sx:{width:120,height:120,border:"4px solid white",boxShadow:2}}),(0,S.jsxs)(i.A,{sx:{flex:1,textAlign:{xs:"center",sm:"left"}},children:[(0,S.jsx)(n.A,{variant:"h4",gutterBottom:!0,fontWeight:"bold",children:e.name}),(0,S.jsx)(n.A,{variant:"body1",sx:{opacity:.9},children:e.email}),(0,S.jsx)(c.A,{label:H.status,sx:{mt:1,backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white","& .MuiChip-label":{fontWeight:"medium"}}})]})]})}),(0,S.jsxs)(i.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(4, 1fr)"},gap:2},children:[(0,S.jsx)(C,{icon:(0,S.jsx)(m.A,{}),label:"Reward Points",value:H.points.toLocaleString()}),(0,S.jsx)(C,{icon:(0,S.jsx)(g.A,{}),label:"Member Status",value:H.status}),(0,S.jsx)(C,{icon:(0,S.jsx)(b.A,{}),label:"Member Since",value:H.memberSince}),(0,S.jsx)(C,{icon:(0,S.jsx)(j.A,{}),label:"Last Purchase",value:H.lastPurchase})]}),(0,S.jsx)(l.A,{children:(0,S.jsxs)(x.A,{children:[(0,S.jsx)(n.A,{variant:"h6",gutterBottom:!0,children:"Progress to Next Tier"}),(0,S.jsxs)(i.A,{sx:{mt:2},children:[(0,S.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,S.jsxs)(n.A,{variant:"body2",color:"text.secondary",children:["Current: ",H.status]}),(0,S.jsxs)(n.A,{variant:"body2",color:"text.secondary",children:[H.pointsToNext," points to next tier"]})]}),(0,S.jsx)(o.A,{variant:"determinate",value:H.progress,sx:{height:8,borderRadius:4,backgroundColor:"rgba(0, 0, 0, 0.04)","& .MuiLinearProgress-bar":{borderRadius:4}}})]})]})}),(0,S.jsx)(l.A,{children:(0,S.jsxs)(x.A,{children:[(0,S.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,S.jsx)(n.A,{variant:"h6",children:"Profile Details"}),(0,S.jsx)(u.A,{startIcon:P?(0,S.jsx)(v.A,{}):(0,S.jsx)(f.A,{}),variant:P?"contained":"outlined",onClick:P?async()=>{D(!0);try{const s=await _(),t=`https://${{NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_AUTH0_DOMAIN}/api/v2/users/${null===e||void 0===e?void 0:e.sub}`;await fetch(t,{method:"PATCH",headers:{Authorization:`Bearer ${s}`,"Content-Type":"application/json"},body:JSON.stringify({user_metadata:W})}),R({open:!0,message:"Profile updated successfully!",severity:"success"}),w(!1)}catch(s){console.error("Error updating user metadata:",s),R({open:!0,message:"Failed to update profile. Please try again.",severity:"error"})}finally{D(!1)}}:()=>w(!0),disabled:E,children:P?E?"Saving...":"Save Changes":"Edit Profile"})]}),(0,S.jsxs)(i.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)"},gap:3},children:[(0,S.jsx)(h.A,{fullWidth:!0,label:"Address",value:W.address||"",onChange:e=>k(s=>({...s,address:e.target.value})),disabled:!P,margin:"normal"}),(0,S.jsx)(h.A,{fullWidth:!0,label:"Phone Number",value:W.phone||"",onChange:e=>k(s=>({...s,phone:e.target.value})),disabled:!P,margin:"normal"}),(0,S.jsx)(h.A,{fullWidth:!0,label:"Birth Date",type:"date",value:W.birthdate||"",onChange:e=>k(s=>({...s,birthdate:e.target.value})),disabled:!P,margin:"normal",InputLabelProps:{shrink:!0}})]})]})})]}),(0,S.jsx)(p.A,{open:O.open,autoHideDuration:6e3,onClose:()=>R(e=>({...e,open:!1})),children:(0,S.jsx)(A.A,{onClose:()=>R(e=>({...e,open:!1})),severity:O.severity,sx:{width:"100%"},children:O.message})})]})}}}]);