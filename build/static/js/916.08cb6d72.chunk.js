"use strict";(self.webpackChunkreact_niq_app=self.webpackChunkreact_niq_app||[]).push([[916],{7916:(e,s,t)=>{t.r(s),t.d(s,{default:()=>T});var a=t(9379),r=t(5043),i=t(5447),n=t(3969),o=t(4842),l=t(6020),d=t(1244),c=t(7873),x=t(3759),u=t(6128),h=t(2097),p=t(3046),A=t(916),m=t(6803),g=t(7931),b=t(7775),j=t(3898),v=t(6691),f=t(2672),y=t(1773),S=t(267),C=t(579);const _=e=>{let{icon:s,label:t,value:a}=e;return(0,C.jsxs)(n.A,{sx:{display:"flex",alignItems:"center",gap:1.5,p:2,backgroundColor:"rgba(0, 0, 0, 0.02)",borderRadius:2},children:[(0,C.jsx)(n.A,{sx:{color:"primary.main"},children:s}),(0,C.jsxs)(n.A,{children:[(0,C.jsx)(o.A,{variant:"body2",color:"text.secondary",children:t}),(0,C.jsx)(o.A,{variant:"subtitle1",fontWeight:"medium",children:a})]})]})},T=()=>{const{user:e,isAuthenticated:s,isLoading:t,getAccessTokenSilently:T}=(0,i.WB)(),P=(0,S.A)(),[w,E]=(0,r.useState)(!1),[D,O]=(0,r.useState)(!1),[R,W]=(0,r.useState)({open:!1,message:"",severity:"success"}),[k,H]=(0,r.useState)({address:"",phone:"",birthdate:"",preferences:{notifications:!0,newsletter:!0}});(0,r.useEffect)((()=>{null!==e&&void 0!==e&&e.sub&&(async()=>{try{const s=await T(),t="https://".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_AUTH0_DOMAIN,"/api/v2/users/").concat(null===e||void 0===e?void 0:e.sub),a=await fetch(t,{headers:{Authorization:"Bearer ".concat(s)}}),{user_metadata:r}=await a.json();r&&H(r)}catch(s){console.error("Error fetching user metadata:",s)}})()}),[T,null===e||void 0===e?void 0:e.sub]);if(t)return(0,C.jsx)(n.A,{sx:{width:"100%",mt:4},children:(0,C.jsx)(l.A,{})});if(!s||!e)return(0,C.jsx)(n.A,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"50vh"},children:(0,C.jsx)(o.A,{variant:"h6",color:"text.secondary",children:"Please log in to view your profile."})});const I={points:1250,status:"Gold Member",memberSince:"January 2024",lastPurchase:"March 15, 2024",progress:75,pointsToNext:250};return(0,C.jsxs)(n.A,{sx:{maxWidth:1200,mx:"auto",p:{xs:2,md:4}},children:[(0,C.jsxs)(n.A,{sx:{display:"flex",flexDirection:"column",gap:4},children:[(0,C.jsx)(d.A,{sx:{position:"relative",overflow:"visible",background:"linear-gradient(45deg, ".concat(P.palette.primary.main,", ").concat(P.palette.secondary.main,")"),color:"white",p:2},children:(0,C.jsxs)(n.A,{sx:{display:"flex",flexDirection:{xs:"column",sm:"row"},alignItems:{xs:"center",sm:"flex-start"},gap:3,position:"relative",zIndex:1},children:[(0,C.jsx)(c.A,{src:e.picture,alt:e.name,sx:{width:120,height:120,border:"4px solid white",boxShadow:2}}),(0,C.jsxs)(n.A,{sx:{flex:1,textAlign:{xs:"center",sm:"left"}},children:[(0,C.jsx)(o.A,{variant:"h4",gutterBottom:!0,fontWeight:"bold",children:e.name}),(0,C.jsx)(o.A,{variant:"body1",sx:{opacity:.9},children:e.email}),(0,C.jsx)(x.A,{label:I.status,sx:{mt:1,backgroundColor:"rgba(255, 255, 255, 0.2)",color:"white","& .MuiChip-label":{fontWeight:"medium"}}})]})]})}),(0,C.jsxs)(n.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)",md:"repeat(4, 1fr)"},gap:2},children:[(0,C.jsx)(_,{icon:(0,C.jsx)(g.A,{}),label:"Reward Points",value:I.points.toLocaleString()}),(0,C.jsx)(_,{icon:(0,C.jsx)(b.A,{}),label:"Member Status",value:I.status}),(0,C.jsx)(_,{icon:(0,C.jsx)(j.A,{}),label:"Member Since",value:I.memberSince}),(0,C.jsx)(_,{icon:(0,C.jsx)(v.A,{}),label:"Last Purchase",value:I.lastPurchase})]}),(0,C.jsx)(d.A,{children:(0,C.jsxs)(u.A,{children:[(0,C.jsx)(o.A,{variant:"h6",gutterBottom:!0,children:"Progress to Next Tier"}),(0,C.jsxs)(n.A,{sx:{mt:2},children:[(0,C.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[(0,C.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:["Current: ",I.status]}),(0,C.jsxs)(o.A,{variant:"body2",color:"text.secondary",children:[I.pointsToNext," points to next tier"]})]}),(0,C.jsx)(l.A,{variant:"determinate",value:I.progress,sx:{height:8,borderRadius:4,backgroundColor:"rgba(0, 0, 0, 0.04)","& .MuiLinearProgress-bar":{borderRadius:4}}})]})]})}),(0,C.jsx)(d.A,{children:(0,C.jsxs)(u.A,{children:[(0,C.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3},children:[(0,C.jsx)(o.A,{variant:"h6",children:"Profile Details"}),(0,C.jsx)(h.A,{startIcon:w?(0,C.jsx)(f.A,{}):(0,C.jsx)(y.A,{}),variant:w?"contained":"outlined",onClick:w?async()=>{O(!0);try{const s=await T(),t="https://".concat({NODE_ENV:"production",PUBLIC_URL:"",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}.REACT_APP_AUTH0_DOMAIN,"/api/v2/users/").concat(null===e||void 0===e?void 0:e.sub);await fetch(t,{method:"PATCH",headers:{Authorization:"Bearer ".concat(s),"Content-Type":"application/json"},body:JSON.stringify({user_metadata:k})}),W({open:!0,message:"Profile updated successfully!",severity:"success"}),E(!1)}catch(s){console.error("Error updating user metadata:",s),W({open:!0,message:"Failed to update profile. Please try again.",severity:"error"})}finally{O(!1)}}:()=>E(!0),disabled:D,children:w?D?"Saving...":"Save Changes":"Edit Profile"})]}),(0,C.jsxs)(n.A,{sx:{display:"grid",gridTemplateColumns:{xs:"1fr",sm:"repeat(2, 1fr)"},gap:3},children:[(0,C.jsx)(p.A,{fullWidth:!0,label:"Address",value:k.address||"",onChange:e=>H((s=>(0,a.A)((0,a.A)({},s),{},{address:e.target.value}))),disabled:!w,margin:"normal"}),(0,C.jsx)(p.A,{fullWidth:!0,label:"Phone Number",value:k.phone||"",onChange:e=>H((s=>(0,a.A)((0,a.A)({},s),{},{phone:e.target.value}))),disabled:!w,margin:"normal"}),(0,C.jsx)(p.A,{fullWidth:!0,label:"Birth Date",type:"date",value:k.birthdate||"",onChange:e=>H((s=>(0,a.A)((0,a.A)({},s),{},{birthdate:e.target.value}))),disabled:!w,margin:"normal",InputLabelProps:{shrink:!0}})]})]})})]}),(0,C.jsx)(A.A,{open:R.open,autoHideDuration:6e3,onClose:()=>W((e=>(0,a.A)((0,a.A)({},e),{},{open:!1}))),children:(0,C.jsx)(m.A,{onClose:()=>W((e=>(0,a.A)((0,a.A)({},e),{},{open:!1}))),severity:R.severity,sx:{width:"100%"},children:R.message})})]})}}}]);
//# sourceMappingURL=916.08cb6d72.chunk.js.map